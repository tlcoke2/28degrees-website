import{r as i,j as e,B as L,T as Q,a as k,P as V,b as q,I as M,D as X,c as Z,d as ee,G as R,e as u,F as te,f as ae,S as ne,M as g,g as se,h as re,i as le,A as ie,k as y}from"./index.BZ6bSIPx.js";import{A as oe}from"./Add.DBOCiMT4.js";import{T as ce,a as de,b as ue,c as b,d as n,e as he}from"./TableRow.nWf7yhOX.js";import{E as me,D as xe}from"./Edit.B9_Pk3f1.js";import{T as ge}from"./TablePagination.DvXGsFG6.js";import{S as pe}from"./Snackbar.DN_5azCV.js";const o=({children:s,...c})=>e.jsx(R,{item:!0,...c,children:s}),A={title:"",description:"",date:"",time:"",location:"",price:0,capacity:50,featured:!1,category:"general",type:"other",imageUrl:""},C={async getAll(){var c;const s=await y.get("/admin/events");return Array.isArray(s.data)?s.data:((c=s.data)==null?void 0:c.data)??[]},create(s){return y.post("/admin/events",s)},update(s,c){return y.put(`/admin/events/${s}`,c)},remove(s){return y.delete(`/admin/events/${s}`)}},Ee=()=>{const[s,c]=i.useState([]),[B,T]=i.useState(!1),[D,p]=i.useState(!1),[U,m]=i.useState(!1),[E,I]=i.useState(!1),[r,x]=i.useState(A),[P,F]=i.useState(0),[j,$]=i.useState(10),[w,S]=i.useState({open:!1,message:"",severity:"success"}),h=i.useCallback((t,a="success")=>{S({open:!0,message:t,severity:a})},[]),f=i.useCallback(async()=>{T(!0);try{const t=await C.getAll();c(t)}catch(t){h((t==null?void 0:t.message)||"Failed to load events","error")}finally{T(!1)}},[h]);i.useEffect(()=>{f()},[f]);const W=i.useMemo(()=>{const t=P*j;return s.slice(t,t+j)},[s,P,j]),d=t=>{const{name:a,value:l}=t.target;x(v=>({...v,[a]:a==="price"||a==="capacity"?Number(l):l}))},G=t=>{const{name:a,value:l}=t.target;x(v=>({...v,[a]:l}))},N=t=>{x(a=>({...a,featured:t.target.checked}))},z=()=>{x(A),I(!1),m(!0)},H=t=>{const{id:a,createdAt:l,updatedAt:v,...K}=t;x({...A,...K,id:a}),I(!0),m(!0)},O=async t=>{t.preventDefault(),p(!0);try{if(E&&r.id){const{id:a,...l}=r;await C.update(a,l),h("Event updated successfully")}else{const{id:a,...l}=r;await C.create(l),h("Event created successfully")}m(!1),await f()}catch(a){h((a==null?void 0:a.message)||"Failed to save event","error")}finally{p(!1)}},Y=async t=>{if(window.confirm("Are you sure you want to delete this event?")){p(!0);try{await C.remove(t),h("Event deleted successfully"),await f()}catch(l){h((l==null?void 0:l.message)||"Failed to delete event","error")}finally{p(!1)}}},_=(t,a)=>F(a),J=t=>{$(parseInt(t.target.value,10)),F(0)};return e.jsxs(L,{p:3,children:[e.jsxs(L,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(Q,{variant:"h5",children:"Events Management"}),e.jsx(k,{variant:"contained",color:"primary",startIcon:e.jsx(oe,{}),onClick:z,children:"Add Event"})]}),e.jsxs(V,{children:[e.jsx(ce,{children:e.jsxs(de,{children:[e.jsx(ue,{children:e.jsxs(b,{children:[e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Date / Time"}),e.jsx(n,{children:"Location"}),e.jsx(n,{align:"right",children:"Price"}),e.jsx(n,{align:"center",children:"Featured"}),e.jsx(n,{children:"Category"}),e.jsx(n,{width:140,align:"right",children:"Actions"})]})}),e.jsx(he,{children:B?e.jsx(b,{children:e.jsx(n,{colSpan:7,align:"center",children:e.jsx(q,{size:24})})}):W.length>0?W.map(t=>e.jsxs(b,{children:[e.jsx(n,{children:t.title}),e.jsxs(n,{children:[t.date,t.time?` ${t.time}`:""]}),e.jsx(n,{children:t.location}),e.jsx(n,{align:"right",children:typeof t.price=="number"?`$${t.price.toFixed(2)}`:"-"}),e.jsx(n,{align:"center",children:t.featured?"Yes":"No"}),e.jsx(n,{children:t.category||"general"}),e.jsxs(n,{align:"right",children:[e.jsx(M,{onClick:()=>H(t),"aria-label":"Edit event",children:e.jsx(me,{})}),e.jsx(M,{onClick:()=>t.id&&Y(t.id),"aria-label":"Delete event",children:e.jsx(xe,{color:"error"})})]})]},t.id)):e.jsx(b,{children:e.jsx(n,{colSpan:7,align:"center",children:"No events found"})})})]})}),e.jsx(ge,{component:"div",count:s.length,page:P,onPageChange:_,rowsPerPage:j,onRowsPerPageChange:J,rowsPerPageOptions:[5,10,25,50]})]}),e.jsx(X,{open:U,onClose:()=>m(!1),maxWidth:"md",fullWidth:!0,children:e.jsxs("form",{onSubmit:O,children:[e.jsx(Z,{children:E?"Edit Event":"Add New Event"}),e.jsx(ee,{children:e.jsxs(R,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(o,{xs:12,children:e.jsx(u,{fullWidth:!0,label:"Title",name:"title",value:r.title,onChange:d,required:!0,margin:"normal"})}),e.jsx(o,{xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"Date",name:"date",type:"date",value:r.date,onChange:d,required:!0,margin:"normal",InputLabelProps:{shrink:!0}})}),e.jsx(o,{xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"Time",name:"time",type:"time",value:r.time,onChange:d,required:!0,margin:"normal",InputLabelProps:{shrink:!0}})}),e.jsx(o,{xs:12,children:e.jsx(u,{fullWidth:!0,label:"Location",name:"location",value:r.location,onChange:d,required:!0,margin:"normal"})}),e.jsx(o,{xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"Price",name:"price",type:"number",value:r.price,onChange:d,required:!0,margin:"normal",inputProps:{min:0,step:"0.01"}})}),e.jsx(o,{xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"Capacity",name:"capacity",type:"number",value:r.capacity,onChange:d,required:!0,margin:"normal",inputProps:{min:1}})}),e.jsx(o,{xs:12,md:6,children:e.jsxs(te,{fullWidth:!0,margin:"normal",children:[e.jsx(ae,{id:"event-category-label",children:"Category"}),e.jsxs(ne,{labelId:"event-category-label",name:"category",value:r.category||"general",onChange:G,label:"Category",required:!0,children:[e.jsx(g,{value:"general",children:"General"}),e.jsx(g,{value:"music",children:"Music"}),e.jsx(g,{value:"sports",children:"Sports"}),e.jsx(g,{value:"food",children:"Food & Drink"}),e.jsx(g,{value:"arts",children:"Arts & Culture"})]})]})}),e.jsx(o,{xs:12,md:6,children:e.jsx(u,{fullWidth:!0,label:"Image URL",name:"imageUrl",value:r.imageUrl||"",onChange:d,margin:"normal"})}),e.jsx(o,{xs:12,children:e.jsx(se,{control:e.jsx(re,{name:"featured",checked:!!r.featured,onChange:N}),label:"Featured Event"})}),e.jsx(o,{xs:12,children:e.jsx(u,{fullWidth:!0,label:"Description",name:"description",value:r.description,onChange:d,multiline:!0,rows:4,margin:"normal"})})]})}),e.jsxs(le,{children:[e.jsx(k,{onClick:()=>m(!1),color:"inherit",children:"Cancel"}),e.jsxs(k,{type:"submit",variant:"contained",color:"primary",disabled:D,startIcon:D?e.jsx(q,{size:20}):void 0,children:[E?"Update":"Create"," Event"]})]})]})}),e.jsx(pe,{open:w.open,autoHideDuration:6e3,onClose:()=>S(t=>({...t,open:!1})),children:e.jsx(ie,{onClose:()=>S(t=>({...t,open:!1})),severity:w.severity,sx:{width:"100%"},children:w.message})})]})};export{Ee as default};
//# sourceMappingURL=EventsManagement.B0t_1YjO.js.map
