{"version":3,"file":"ContentEditor.XD1chWql.js","sources":["../../src/services/contentService.ts","../../src/pages/admin/ContentEditor.tsx"],"sourcesContent":["// src/services/contentService.ts\r\nimport { api } from './http';\r\n\r\n/**\r\n * Shapes are flexible because different sections (home/about/etc.)\r\n * can store different fields. Keep it open-ended.\r\n */\r\nexport type ContentSection = 'home' | 'about' | 'footer' | 'header' | string;\r\nexport type ContentData = Record<string, any>;\r\n\r\nfunction adminAuthHeaders() {\r\n  if (typeof window === 'undefined') return {};\r\n  const token = localStorage.getItem('adminToken');\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}\r\n\r\n/* ------------------------------- Public ------------------------------- */\r\n/** GET /api/v1/content/:section */\r\nexport async function getPublic(section: ContentSection): Promise<ContentData> {\r\n  const path = `/content/${encodeURIComponent(section)}`;\r\n  const res = await api.get(path);\r\n  return (res?.data?.data ?? res?.data ?? {}) as ContentData;\r\n}\r\n\r\n/* ------------------------------- Admin -------------------------------- */\r\n/**\r\n * Admin endpoints require a bearer token. If it’s missing/expired you’ll get 401/403.\r\n * Paths used by the backend:\r\n *  - GET /api/v1/content/:section/admin\r\n *  - PUT /api/v1/content/:section/admin\r\n */\r\nexport async function getAdmin(section: ContentSection): Promise<ContentData> {\r\n  const headers = adminAuthHeaders();\r\n  if (!('Authorization' in headers)) {\r\n    throw new Error('Admin authentication required. Please log in to the admin panel.');\r\n  }\r\n  const path = `/content/${encodeURIComponent(section)}/admin`;\r\n  const res = await api.get(path, { headers });\r\n  return (res?.data?.data ?? res?.data ?? {}) as ContentData;\r\n}\r\n\r\nexport async function updateAdmin(\r\n  section: ContentSection,\r\n  payload: ContentData\r\n): Promise<ContentData> {\r\n  const headers = adminAuthHeaders();\r\n  if (!('Authorization' in headers)) {\r\n    throw new Error('Admin authentication required. Please log in to the admin panel.');\r\n  }\r\n  const path = `/content/${encodeURIComponent(section)}/admin`;\r\n  const res = await api.put(path, payload, { headers });\r\n  return (res?.data?.data ?? res?.data ?? {}) as ContentData;\r\n}\r\n\r\n/* ------------------------------ Helper -------------------------------- */\r\n/**\r\n * Convenience: if logged in as admin, try admin endpoint first to get the\r\n * editable payload; otherwise fall back to public content.\r\n */\r\nexport async function getEditable(section: ContentSection): Promise<ContentData> {\r\n  try {\r\n    const headers = adminAuthHeaders();\r\n    if ('Authorization' in headers) {\r\n      return await getAdmin(section);\r\n    }\r\n  } catch {\r\n    // ignore and fall through to public\r\n  }\r\n  return getPublic(section);\r\n}\r\n\r\nexport default {\r\n  getPublic,\r\n  getAdmin,\r\n  updateAdmin,\r\n  getEditable,\r\n};\r\n","// src/pages/admin/ContentEditor.tsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport {\r\n  Box,\r\n  Container,\r\n  Typography,\r\n  Paper,\r\n  Grid,\r\n  TextField,\r\n  Button,\r\n  Alert,\r\n  CircularProgress,\r\n  Stack,\r\n} from '@mui/material';\r\nimport contentService, { type ContentData } from '../../services/contentService';\r\n\r\n// ----- Local content shapes you’re editing here -----\r\nexport type HomeContent = {\r\n  heroTitle?: string;\r\n  heroSubtitle?: string;\r\n  heroImageUrl?: string;\r\n  // add more editable home fields here as needed\r\n};\r\n\r\nexport type AboutContent = {\r\n  title?: string;\r\n  subtitle?: string;\r\n  bannerImageUrl?: string;\r\n  body?: string;\r\n  // add more editable about fields here as needed\r\n};\r\n\r\nconst ContentEditor: React.FC = () => {\r\n  const [home, setHome] = useState<HomeContent>({});\r\n  const [about, setAbout] = useState<AboutContent>({});\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n\r\n  // Load existing content (admin if logged in, otherwise public)\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError('');\r\n        const [homeData, aboutData] = await Promise.all([\r\n          contentService.getEditable('home'),\r\n          contentService.getEditable('about'),\r\n        ]);\r\n\r\n        if (!mounted) return;\r\n\r\n        // Coerce to our local shapes; keep unknown fields intact to avoid losing data\r\n        setHome((homeData || {}) as HomeContent);\r\n        setAbout((aboutData || {}) as AboutContent);\r\n      } catch (e: any) {\r\n        setError(e?.message || 'Failed to load content');\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  // Save both sections (you can split into per-section saves if you prefer)\r\n  const handleSaveAll = async () => {\r\n    try {\r\n      setSaving(true);\r\n      setError('');\r\n      setSuccess('');\r\n\r\n      // Save in sequence; if one fails, show the error\r\n      await contentService.updateAdmin('home', home as ContentData);\r\n      await contentService.updateAdmin('about', about as ContentData);\r\n\r\n      setSuccess('Content saved successfully.');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to save content.');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container maxWidth=\"lg\" sx={{ py: 6 }}>\r\n        <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\" minHeight={240}>\r\n          <CircularProgress />\r\n        </Box>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\r\n      <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"space-between\" sx={{ mb: 2 }}>\r\n        <Typography variant=\"h4\">Content Editor</Typography>\r\n        <Button\r\n          variant=\"contained\"\r\n          onClick={handleSaveAll}\r\n          disabled={saving}\r\n          startIcon={saving ? <CircularProgress size={18} /> : undefined}\r\n        >\r\n          {saving ? 'Saving…' : 'Save All'}\r\n        </Button>\r\n      </Stack>\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n      {success && (\r\n        <Alert severity=\"success\" sx={{ mb: 2 }}>\r\n          {success}\r\n        </Alert>\r\n      )}\r\n\r\n      {/* HOME SECTION */}\r\n      <Paper sx={{ p: 3, mb: 4 }}>\r\n        <Typography variant=\"h6\" sx={{ mb: 2 }}>\r\n          Home Page\r\n        </Typography>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Hero Title\"\r\n              value={home.heroTitle || ''}\r\n              onChange={(e) =>\r\n                setHome((s: HomeContent) => ({ ...s, heroTitle: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Hero Subtitle\"\r\n              value={home.heroSubtitle || ''}\r\n              onChange={(e) =>\r\n                setHome((s: HomeContent) => ({ ...s, heroSubtitle: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Hero Image URL\"\r\n              value={home.heroImageUrl || ''}\r\n              onChange={(e) =>\r\n                setHome((s: HomeContent) => ({ ...s, heroImageUrl: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </Paper>\r\n\r\n      {/* ABOUT SECTION */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Typography variant=\"h6\" sx={{ mb: 2 }}>\r\n          About Page\r\n        </Typography>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Title\"\r\n              value={about.title || ''}\r\n              onChange={(e) =>\r\n                setAbout((s: AboutContent) => ({ ...s, title: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Subtitle\"\r\n              value={about.subtitle || ''}\r\n              onChange={(e) =>\r\n                setAbout((s: AboutContent) => ({ ...s, subtitle: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Banner Image URL\"\r\n              value={about.bannerImageUrl || ''}\r\n              onChange={(e) =>\r\n                setAbout((s: AboutContent) => ({ ...s, bannerImageUrl: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              fullWidth\r\n              multiline\r\n              minRows={6}\r\n              label=\"Body\"\r\n              value={about.body || ''}\r\n              onChange={(e) =>\r\n                setAbout((s: AboutContent) => ({ ...s, body: e.target.value }))\r\n              }\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </Paper>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default ContentEditor;\r\n"],"names":["adminAuthHeaders","token","getPublic","section","path","res","api","_a","getAdmin","headers","updateAdmin","payload","getEditable","contentService","ContentEditor","home","setHome","useState","about","setAbout","loading","setLoading","saving","setSaving","error","setError","success","setSuccess","useEffect","mounted","homeData","aboutData","e","handleSaveAll","jsx","Container","Box","CircularProgress","jsxs","Stack","Typography","Button","Alert","Paper","Grid","TextField","s"],"mappings":"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"}