import{r as l,t as y,j as e,B,T as X,a as A,P as Z,b as N,I as U,D as ee,c as ae,d as te,G as q,e as d,F as D,f as k,S as I,M as o,g as re,h as se,i as ne,A as le}from"./index.BZ6bSIPx.js";import{A as ie}from"./Add.DBOCiMT4.js";import{T as oe,a as ce,b as de,c as b,d as r,e as ue}from"./TableRow.nWf7yhOX.js";import{E as he,D as xe}from"./Edit.B9_Pk3f1.js";import{T as me}from"./TablePagination.DvXGsFG6.js";import{S as ge}from"./Snackbar.DN_5azCV.js";const i=({children:m,...C})=>e.jsx(q,{item:!0,...C,children:m}),E={title:"",description:"",duration:"",location:"",price:0,capacity:10,difficulty:"easy",featured:!1,category:"adventure",imageUrl:"",type:"tour",maxAttendees:10},ve=()=>{const[m,C]=l.useState([]),[G,W]=l.useState(!1),[F,j]=l.useState(!1),[H,g]=l.useState(!1),[v,M]=l.useState(!1),[s,u]=l.useState(E),[T,L]=l.useState(0),[f,z]=l.useState(10),[P,S]=l.useState({open:!1,message:"",severity:"success"}),h=(a,t="success")=>S({open:!0,message:a,severity:t}),p=l.useCallback(async()=>{W(!0);try{const a=await y.getAllTours();C(a||[])}catch(a){h((a==null?void 0:a.message)||"Failed to load tours","error")}finally{W(!1)}},[]);l.useEffect(()=>{p()},[p]);const R=l.useMemo(()=>{const a=T*f;return m.slice(a,a+f)},[m,T,f]),c=a=>{const{name:t,value:n}=a.target;["price","capacity","maxAttendees"].includes(t)?u(x=>({...x,[t]:Number(n)})):u(x=>({...x,[t]:n}))},w=a=>{const{name:t,value:n}=a.target;u(x=>({...x,[t]:n}))},O=a=>{u(t=>({...t,featured:a.target.checked}))},$=()=>{u(E),M(!1),g(!0)},Y=a=>{const{id:t,createdAt:n,updatedAt:x,...V}=a;u({...E,...V,id:t}),M(!0),g(!0)},_=async a=>{a.preventDefault(),j(!0);try{if(v&&s.id){const{id:t,...n}=s;await y.updateTour(t,n),h("Tour updated successfully")}else{const{id:t,...n}=s;await y.createTour(n),h("Tour created successfully")}g(!1),await p()}catch(t){h((t==null?void 0:t.message)||"Failed to save tour","error")}finally{j(!1)}},J=async a=>{if(window.confirm("Are you sure you want to delete this tour?")){j(!0);try{await y.deleteTour(a),h("Tour deleted successfully"),await p()}catch(n){h((n==null?void 0:n.message)||"Failed to delete tour","error")}finally{j(!1)}}},K=(a,t)=>L(t),Q=a=>{z(parseInt(a.target.value,10)),L(0)};return e.jsxs(B,{p:3,children:[e.jsxs(B,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(X,{variant:"h5",children:"Tours Management"}),e.jsx(A,{variant:"contained",color:"primary",startIcon:e.jsx(ie,{}),onClick:$,children:"Add Tour"})]}),e.jsxs(Z,{children:[e.jsx(oe,{children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(b,{children:[e.jsx(r,{children:"Title"}),e.jsx(r,{children:"Duration"}),e.jsx(r,{children:"Location"}),e.jsx(r,{align:"right",children:"Price"}),e.jsx(r,{children:"Difficulty"}),e.jsx(r,{children:"Category"}),e.jsx(r,{align:"center",children:"Featured"}),e.jsx(r,{width:140,align:"right",children:"Actions"})]})}),e.jsx(ue,{children:G?e.jsx(b,{children:e.jsx(r,{colSpan:8,align:"center",children:e.jsx(N,{size:24})})}):R.length>0?R.map(a=>e.jsxs(b,{children:[e.jsx(r,{children:a.title}),e.jsx(r,{children:a.duration}),e.jsx(r,{children:a.location}),e.jsx(r,{align:"right",children:typeof a.price=="number"?`$${a.price.toFixed(2)}`:"-"}),e.jsx(r,{children:a.difficulty||"-"}),e.jsx(r,{children:a.category||"-"}),e.jsx(r,{align:"center",children:a.featured?"Yes":"No"}),e.jsxs(r,{align:"right",children:[e.jsx(U,{onClick:()=>Y(a),"aria-label":"Edit tour",children:e.jsx(he,{})}),e.jsx(U,{onClick:()=>a.id&&J(a.id),"aria-label":"Delete tour",children:e.jsx(xe,{color:"error"})})]})]},a.id)):e.jsx(b,{children:e.jsx(r,{colSpan:8,align:"center",children:"No tours found"})})})]})}),e.jsx(me,{component:"div",count:m.length,page:T,onPageChange:K,rowsPerPage:f,onRowsPerPageChange:Q,rowsPerPageOptions:[5,10,25,50]})]}),e.jsx(ee,{open:H,onClose:()=>g(!1),maxWidth:"md",fullWidth:!0,children:e.jsxs("form",{onSubmit:_,children:[e.jsx(ae,{children:v?"Edit Tour":"Add New Tour"}),e.jsx(te,{children:e.jsxs(q,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(i,{xs:12,children:e.jsx(d,{fullWidth:!0,label:"Title",name:"title",value:s.title,onChange:c,required:!0,margin:"normal"})}),e.jsx(i,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Duration",name:"duration",value:s.duration,onChange:c,required:!0,margin:"normal"})}),e.jsx(i,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Location",name:"location",value:s.location,onChange:c,required:!0,margin:"normal"})}),e.jsx(i,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Price",name:"price",type:"number",value:s.price,onChange:c,required:!0,margin:"normal",inputProps:{min:0,step:"0.01"}})}),e.jsx(i,{xs:12,md:6,children:e.jsxs(D,{fullWidth:!0,margin:"normal",children:[e.jsx(k,{id:"tour-difficulty-label",children:"Difficulty"}),e.jsxs(I,{labelId:"tour-difficulty-label",name:"difficulty",value:s.difficulty||"easy",onChange:w,label:"Difficulty",children:[e.jsx(o,{value:"easy",children:"Easy"}),e.jsx(o,{value:"medium",children:"Medium"}),e.jsx(o,{value:"hard",children:"Hard"})]})]})}),e.jsx(i,{xs:12,md:6,children:e.jsxs(D,{fullWidth:!0,margin:"normal",children:[e.jsx(k,{id:"tour-category-label",children:"Category"}),e.jsxs(I,{labelId:"tour-category-label",name:"category",value:s.category||"adventure",onChange:w,label:"Category",children:[e.jsx(o,{value:"adventure",children:"Adventure"}),e.jsx(o,{value:"cultural",children:"Cultural"}),e.jsx(o,{value:"culinary",children:"Culinary"}),e.jsx(o,{value:"nature",children:"Nature"})]})]})}),e.jsx(i,{xs:12,md:6,children:e.jsxs(D,{fullWidth:!0,margin:"normal",children:[e.jsx(k,{id:"tour-type-label",children:"Type"}),e.jsxs(I,{labelId:"tour-type-label",name:"type",value:s.type||"tour",onChange:w,label:"Type",children:[e.jsx(o,{value:"tour",children:"Tour"}),e.jsx(o,{value:"experience",children:"Experience"}),e.jsx(o,{value:"package",children:"Package"})]})]})}),e.jsx(i,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Max Attendees",name:"maxAttendees",type:"number",value:s.maxAttendees??10,onChange:c,margin:"normal",inputProps:{min:1}})}),e.jsx(i,{xs:12,children:e.jsx(re,{control:e.jsx(se,{name:"featured",checked:!!s.featured,onChange:O}),label:"Featured Tour"})}),e.jsx(i,{xs:12,children:e.jsx(d,{fullWidth:!0,label:"Image URL",name:"imageUrl",value:s.imageUrl||"",onChange:c,margin:"normal"})}),e.jsx(i,{xs:12,children:e.jsx(d,{fullWidth:!0,label:"Description",name:"description",value:s.description||"",onChange:c,multiline:!0,rows:4,margin:"normal"})})]})}),e.jsxs(ne,{children:[e.jsx(A,{onClick:()=>g(!1),color:"inherit",children:"Cancel"}),e.jsxs(A,{type:"submit",variant:"contained",color:"primary",disabled:F,startIcon:F?e.jsx(N,{size:20}):void 0,children:[v?"Update":"Create"," Tour"]})]})]})}),e.jsx(ge,{open:P.open,autoHideDuration:6e3,onClose:()=>S(a=>({...a,open:!1})),children:e.jsx(le,{onClose:()=>S(a=>({...a,open:!1})),severity:P.severity,sx:{width:"100%"},children:P.message})})]})};export{ve as default};
//# sourceMappingURL=ToursManagement.gSTryWPu.js.map
